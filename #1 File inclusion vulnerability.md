# File inclusion vulnerability

## Features 

- commonly found on run time
- different from **directory traversal attack**
    - d.t.a : is a way of gaining unauthorized file system access
    - f.i.v : suberts how an application loads code for **execution**
- A **successful** exploitation of a file inclusion vulnerability can result in **remote code execution**, and attacker can use remote code execution to create a *webshell* on that web server.



## Types

1. Remote file inclusion (**RFI**): RFI usually occurs when the web application downloads and executes a remote file. These remote files usually obtained in the form of an **HTTP** or **FTP** URI as a user-supplied parameter to the web application.
2. Local file inclusion (**LFI**): LFI is similar to RFI except instead of including remote files, only local files. i.e. files on the current server can be included for execution. This issue can still **lead to RFI** by including a (local) file that contains attacker-controlled data such as **the web server's access log**.



## How 

### 1. PHP:

1. *Most notable*(NOT ALL) are the `include` and `require` statements.
2. Use a URL to retrieve data from remote locations:
    1. PHP <= 4.3.4: `allow_url_fopen = On`, **enable by default**.
    2. PHP >= 5.2.0: `allow_url_include` , but fortunately, in 5.X this directive is **disabled by default**.
3. Attacker will alter a variable that is passed to one of these functions to cause it to include malicious code from a remote host.
4. **HOW TO MITIGATE**: **all** user input **needs to be validated** before being used! **Users can not be trusted!**



