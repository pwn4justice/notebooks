## 审计方法与步骤

- 网站结构
    - 浏览源码，了解大致目录，猜测大致流程
- 入口文件
    - index 详读，程序架构，运行流程，包含哪些配置文件，哪些是过滤文件与安全函数，了解大致业务逻辑
    - admin
- 配置文件
    - config | cfg | conf 等等
    - 数据库相关信息
        - 编码（GBK 就宽子节注入）
    - 变量值双引号，就可能存在双引号解析代码执行的问题
- 过滤功能
    - 公共函数文件
    - 安全过滤（功能）文件
    - 了解哪些用户输入**可控**，哪些被过滤，被怎样过滤，是否能绕过，过滤的方式是替换还是正则，有没有 gpc，以及使用 addslasher 处理，并在该过程做好记录

### 审计方法

- 通读全文（把握大局）
- 敏感函数回溯（如 shell_exec， eval）
- 定向功能分析
    - 初始安装功能
    - 站点探针功能
    - 文件上传管理相关功能
    - 登陆认证功能
    - 数据库相关功能等
    - 验证码相关功能等

